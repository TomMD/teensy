<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>LUFA Library - Mass Storage Device Demo: MassStorage.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>MassStorage.h File Reference</h1><code>#include &lt;avr/io.h&gt;</code><br/>
<code>#include &lt;avr/wdt.h&gt;</code><br/>
<code>#include &lt;avr/power.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="a00007.html">Descriptors.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="a00011.html">Lib/SCSI.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="a00009.html">Lib/DataflashManager.h</a>&quot;</code><br/>
<code>#include &lt;LUFA/Version.h&gt;</code><br/>
<code>#include &lt;LUFA/Drivers/USB/USB.h&gt;</code><br/>
<code>#include &lt;LUFA/Drivers/Board/LEDs.h&gt;</code><br/>
<code>#include &lt;LUFA/Drivers/Board/Dataflash.h&gt;</code><br/>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00001.html">CommandBlockWrapper_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00002.html">CommandStatusWrapper_t</a></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00014.html#acb9a039894443da8410cb4fa3df22be6">REQ_MassStorageReset</a>&nbsp;&nbsp;&nbsp;0xFF</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00014.html#ac0876c839c43c9c05f5a917d3b46ceaf">REQ_GetMaxLUN</a>&nbsp;&nbsp;&nbsp;0xFE</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00014.html#ae165b536bdf28074c6a66be81866b866">MAX_SCSI_COMMAND_LENGTH</a>&nbsp;&nbsp;&nbsp;16</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00014.html#a50367256bfbc0d0b9d6fd42fb63e78a9">TOTAL_LUNS</a>&nbsp;&nbsp;&nbsp;1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00014.html#a74ba398e7640ffa25cfd45e346ba7c17">LUN_MEDIA_BLOCKS</a>&nbsp;&nbsp;&nbsp;(VIRTUAL_MEMORY_BLOCKS / TOTAL_LUNS)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00014.html#ac6720d81afa7c89b4ac87928c591883c">CBW_SIGNATURE</a>&nbsp;&nbsp;&nbsp;0x43425355UL</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00014.html#aa64c08764b0b19dd484ee177c32bcf49">CSW_SIGNATURE</a>&nbsp;&nbsp;&nbsp;0x53425355UL</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00014.html#a67558cbba737fb0f865d76920dde0449">COMMAND_DIRECTION_DATA_OUT</a>&nbsp;&nbsp;&nbsp;(0 &lt;&lt; 7)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00014.html#a0d1cac717714b1805917994b1671b61b">COMMAND_DIRECTION_DATA_IN</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 7)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00014.html#a35a06cf522ba5b8ef837c8c5e0bee17b">LEDMASK_USB_NOTREADY</a>&nbsp;&nbsp;&nbsp;LEDS_LED1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00014.html#ae5f555e6ba3f29cf2683653715b2882b">LEDMASK_USB_ENUMERATING</a>&nbsp;&nbsp;&nbsp;(LEDS_LED2 | LEDS_LED3)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00014.html#a1bdfeb2384ab943afb611716fb2034ee">LEDMASK_USB_READY</a>&nbsp;&nbsp;&nbsp;(LEDS_LED2 | LEDS_LED4)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00014.html#a9c02d2f661a67e5d895a637b1786e495">LEDMASK_USB_ERROR</a>&nbsp;&nbsp;&nbsp;(LEDS_LED1 | LEDS_LED3)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00014.html#a8e041687ba6fa46320c904de65419fa8">LEDMASK_USB_BUSY</a>&nbsp;&nbsp;&nbsp;(LEDS_LED2)</td></tr>
<tr><td colspan="2"><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00014.html#a9bbdc5049471e62c0a68aab12c530f7d">MassStorage_CommandStatusCodes_t</a> { <br/>
&nbsp;&nbsp;<a class="el" href="a00014.html#a9bbdc5049471e62c0a68aab12c530f7da0161cfb22f2537931b6703dd1210dcff">Command_Pass</a> =  0, 
<br/>
&nbsp;&nbsp;<a class="el" href="a00014.html#a9bbdc5049471e62c0a68aab12c530f7da9c35fdf9575a3704e1b90560ff2cba80">Command_Fail</a> =  1, 
<br/>
&nbsp;&nbsp;<a class="el" href="a00014.html#a9bbdc5049471e62c0a68aab12c530f7da0954410ecc72a454dfb225821db81d3b">Phase_Error</a> =  2
<br/>
 }</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00014.html#acb27e569c06a2797c5fd58ed39147448">SetupHardware</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00014.html#a2366751aad393f7e49384b76dfdbfc05">MassStorage_Task</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00014.html#aeff97648c9250a3d398bb0b74f040899">EVENT_USB_Device_Connect</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00014.html#ae88405d14d8d6dada9313520cb1501ec">EVENT_USB_Device_Disconnect</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00014.html#a953a275884b9e33629ff6323fca05252">EVENT_USB_Device_ConfigurationChanged</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00014.html#abbebc3cb66ac3945b938ae5b93a71ea8">EVENT_USB_Device_UnhandledControlRequest</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00014.html#a198e781643cf3ee5aa8bea888b3a2ab4">ReadInCommandBlock</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00014.html#a35e2afa9515551556bdb41d29f6b9eb2">ReturnCommandStatus</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00014.html#a0404d021554ccc86fcb2b40c3083aeb4">StreamCallback_AbortOnMassStoreReset</a> (void)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00001.html">CommandBlockWrapper_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00014.html#a31780559e7a9c322e16adb1d2ef4625e">CommandBlock</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00002.html">CommandStatusWrapper_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00014.html#adbb7d1de681baffcbb200c3c4eb8e73e">CommandStatus</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">volatile bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00014.html#aa696f7a79b9109ea7f508d87861e1bf9">IsMassStoreReset</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Header file for <a class="el" href="a00013.html">MassStorage.c</a>. </p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="ac6720d81afa7c89b4ac87928c591883c"></a><!-- doxytag: member="MassStorage.h::CBW_SIGNATURE" ref="ac6720d81afa7c89b4ac87928c591883c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CBW_SIGNATURE&nbsp;&nbsp;&nbsp;0x43425355UL</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Magic signature for a Command Block Wrapper used in the Mass Storage Bulk-Only transport protocol. </p>

</div>
</div>
<a class="anchor" id="a0d1cac717714b1805917994b1671b61b"></a><!-- doxytag: member="MassStorage.h::COMMAND_DIRECTION_DATA_IN" ref="a0d1cac717714b1805917994b1671b61b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define COMMAND_DIRECTION_DATA_IN&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 7)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Mask for a Command Block Wrapper's flags attribute to specify a command with data sent from device-to-host. </p>

</div>
</div>
<a class="anchor" id="a67558cbba737fb0f865d76920dde0449"></a><!-- doxytag: member="MassStorage.h::COMMAND_DIRECTION_DATA_OUT" ref="a67558cbba737fb0f865d76920dde0449" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define COMMAND_DIRECTION_DATA_OUT&nbsp;&nbsp;&nbsp;(0 &lt;&lt; 7)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Mask for a Command Block Wrapper's flags attribute to specify a command with data sent from host-to-device. </p>

</div>
</div>
<a class="anchor" id="aa64c08764b0b19dd484ee177c32bcf49"></a><!-- doxytag: member="MassStorage.h::CSW_SIGNATURE" ref="aa64c08764b0b19dd484ee177c32bcf49" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CSW_SIGNATURE&nbsp;&nbsp;&nbsp;0x53425355UL</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Magic signature for a Command Status Wrapper used in the Mass Storage Bulk-Only transport protocol. </p>

</div>
</div>
<a class="anchor" id="a8e041687ba6fa46320c904de65419fa8"></a><!-- doxytag: member="MassStorage.h::LEDMASK_USB_BUSY" ref="a8e041687ba6fa46320c904de65419fa8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LEDMASK_USB_BUSY&nbsp;&nbsp;&nbsp;(LEDS_LED2)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>LED mask for the library LED driver, to indicate that the USB interface is busy. </p>

</div>
</div>
<a class="anchor" id="ae5f555e6ba3f29cf2683653715b2882b"></a><!-- doxytag: member="MassStorage.h::LEDMASK_USB_ENUMERATING" ref="ae5f555e6ba3f29cf2683653715b2882b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LEDMASK_USB_ENUMERATING&nbsp;&nbsp;&nbsp;(LEDS_LED2 | LEDS_LED3)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>LED mask for the library LED driver, to indicate that the USB interface is enumerating. </p>

</div>
</div>
<a class="anchor" id="a9c02d2f661a67e5d895a637b1786e495"></a><!-- doxytag: member="MassStorage.h::LEDMASK_USB_ERROR" ref="a9c02d2f661a67e5d895a637b1786e495" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LEDMASK_USB_ERROR&nbsp;&nbsp;&nbsp;(LEDS_LED1 | LEDS_LED3)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>LED mask for the library LED driver, to indicate that an error has occurred in the USB interface. </p>

</div>
</div>
<a class="anchor" id="a35a06cf522ba5b8ef837c8c5e0bee17b"></a><!-- doxytag: member="MassStorage.h::LEDMASK_USB_NOTREADY" ref="a35a06cf522ba5b8ef837c8c5e0bee17b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LEDMASK_USB_NOTREADY&nbsp;&nbsp;&nbsp;LEDS_LED1</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>LED mask for the library LED driver, to indicate that the USB interface is not ready. </p>

</div>
</div>
<a class="anchor" id="a1bdfeb2384ab943afb611716fb2034ee"></a><!-- doxytag: member="MassStorage.h::LEDMASK_USB_READY" ref="a1bdfeb2384ab943afb611716fb2034ee" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LEDMASK_USB_READY&nbsp;&nbsp;&nbsp;(LEDS_LED2 | LEDS_LED4)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>LED mask for the library LED driver, to indicate that the USB interface is ready. </p>

</div>
</div>
<a class="anchor" id="a74ba398e7640ffa25cfd45e346ba7c17"></a><!-- doxytag: member="MassStorage.h::LUN_MEDIA_BLOCKS" ref="a74ba398e7640ffa25cfd45e346ba7c17" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LUN_MEDIA_BLOCKS&nbsp;&nbsp;&nbsp;(VIRTUAL_MEMORY_BLOCKS / TOTAL_LUNS)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Blocks in each LUN, calculated from the total capacity divided by the total number of Logical Units in the device. </p>

</div>
</div>
<a class="anchor" id="ae165b536bdf28074c6a66be81866b866"></a><!-- doxytag: member="MassStorage.h::MAX_SCSI_COMMAND_LENGTH" ref="ae165b536bdf28074c6a66be81866b866" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_SCSI_COMMAND_LENGTH&nbsp;&nbsp;&nbsp;16</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Maximum length of a SCSI command which can be issued by the device or host in a Mass Storage bulk wrapper. </p>

</div>
</div>
<a class="anchor" id="ac0876c839c43c9c05f5a917d3b46ceaf"></a><!-- doxytag: member="MassStorage.h::REQ_GetMaxLUN" ref="ac0876c839c43c9c05f5a917d3b46ceaf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define REQ_GetMaxLUN&nbsp;&nbsp;&nbsp;0xFE</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Mass Storage Class specific request to retrieve the total number of Logical Units (drives) in the SCSI device. </p>

</div>
</div>
<a class="anchor" id="acb9a039894443da8410cb4fa3df22be6"></a><!-- doxytag: member="MassStorage.h::REQ_MassStorageReset" ref="acb9a039894443da8410cb4fa3df22be6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define REQ_MassStorageReset&nbsp;&nbsp;&nbsp;0xFF</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Mass Storage Class specific request to reset the Mass Storage interface, ready for the next command. </p>

</div>
</div>
<a class="anchor" id="a50367256bfbc0d0b9d6fd42fb63e78a9"></a><!-- doxytag: member="MassStorage.h::TOTAL_LUNS" ref="a50367256bfbc0d0b9d6fd42fb63e78a9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TOTAL_LUNS&nbsp;&nbsp;&nbsp;1</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Total number of Logical Units (drives) in the device. The total device capacity is shared equally between each drive - this can be set to any positive non-zero amount. </p>

</div>
</div>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="a9bbdc5049471e62c0a68aab12c530f7d"></a><!-- doxytag: member="MassStorage.h::MassStorage_CommandStatusCodes_t" ref="a9bbdc5049471e62c0a68aab12c530f7d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="a00014.html#a9bbdc5049471e62c0a68aab12c530f7d">MassStorage_CommandStatusCodes_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Enum for the possible command status wrapper return status codes. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a9bbdc5049471e62c0a68aab12c530f7da0161cfb22f2537931b6703dd1210dcff"></a><!-- doxytag: member="Command_Pass" ref="a9bbdc5049471e62c0a68aab12c530f7da0161cfb22f2537931b6703dd1210dcff" args="" -->Command_Pass</em>&nbsp;</td><td>
<p>Command completed with no error </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a9bbdc5049471e62c0a68aab12c530f7da9c35fdf9575a3704e1b90560ff2cba80"></a><!-- doxytag: member="Command_Fail" ref="a9bbdc5049471e62c0a68aab12c530f7da9c35fdf9575a3704e1b90560ff2cba80" args="" -->Command_Fail</em>&nbsp;</td><td>
<p>Command failed to complete - host may check the exact error via a SCSI REQUEST SENSE command </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a9bbdc5049471e62c0a68aab12c530f7da0954410ecc72a454dfb225821db81d3b"></a><!-- doxytag: member="Phase_Error" ref="a9bbdc5049471e62c0a68aab12c530f7da0954410ecc72a454dfb225821db81d3b" args="" -->Phase_Error</em>&nbsp;</td><td>
<p>Command failed due to being invalid in the current phase </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a953a275884b9e33629ff6323fca05252"></a><!-- doxytag: member="MassStorage.h::EVENT_USB_Device_ConfigurationChanged" ref="a953a275884b9e33629ff6323fca05252" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EVENT_USB_Device_ConfigurationChanged </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Event handler for the USB_ConfigurationChanged event. This is fired when the host set the current configuration of the USB device after enumeration - the device endpoints are configured and the Mass Storage management task started. </p>

</div>
</div>
<a class="anchor" id="aeff97648c9250a3d398bb0b74f040899"></a><!-- doxytag: member="MassStorage.h::EVENT_USB_Device_Connect" ref="aeff97648c9250a3d398bb0b74f040899" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EVENT_USB_Device_Connect </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Event handler for the USB_Connect event. This indicates that the device is enumerating via the status LEDs. </p>

</div>
</div>
<a class="anchor" id="ae88405d14d8d6dada9313520cb1501ec"></a><!-- doxytag: member="MassStorage.h::EVENT_USB_Device_Disconnect" ref="ae88405d14d8d6dada9313520cb1501ec" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EVENT_USB_Device_Disconnect </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Event handler for the USB_Disconnect event. This indicates that the device is no longer connected to a host via the status LEDs and stops the Mass Storage management task. </p>

</div>
</div>
<a class="anchor" id="abbebc3cb66ac3945b938ae5b93a71ea8"></a><!-- doxytag: member="MassStorage.h::EVENT_USB_Device_UnhandledControlRequest" ref="abbebc3cb66ac3945b938ae5b93a71ea8" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EVENT_USB_Device_UnhandledControlRequest </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Event handler for the USB_UnhandledControlPacket event. This is used to catch standard and class specific control requests that are not handled internally by the USB library (including the Mass Storage class-specific requests) so that they can be handled appropriately for the application. </p>

</div>
</div>
<a class="anchor" id="a2366751aad393f7e49384b76dfdbfc05"></a><!-- doxytag: member="MassStorage.h::MassStorage_Task" ref="a2366751aad393f7e49384b76dfdbfc05" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MassStorage_Task </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Task to manage the Mass Storage interface, reading in Command Block Wrappers from the host, processing the SCSI commands they contain, and returning Command Status Wrappers back to the host to indicate the success or failure of the last issued command. </p>

</div>
</div>
<a class="anchor" id="a198e781643cf3ee5aa8bea888b3a2ab4"></a><!-- doxytag: member="MassStorage.h::ReadInCommandBlock" ref="a198e781643cf3ee5aa8bea888b3a2ab4" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool ReadInCommandBlock </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a35e2afa9515551556bdb41d29f6b9eb2"></a><!-- doxytag: member="MassStorage.h::ReturnCommandStatus" ref="a35e2afa9515551556bdb41d29f6b9eb2" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ReturnCommandStatus </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="acb27e569c06a2797c5fd58ed39147448"></a><!-- doxytag: member="MassStorage.h::SetupHardware" ref="acb27e569c06a2797c5fd58ed39147448" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetupHardware </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Configures the board hardware and chip peripherals for the demo's functionality. </p>

</div>
</div>
<a class="anchor" id="a0404d021554ccc86fcb2b40c3083aeb4"></a><!-- doxytag: member="MassStorage.h::StreamCallback_AbortOnMassStoreReset" ref="a0404d021554ccc86fcb2b40c3083aeb4" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t StreamCallback_AbortOnMassStoreReset </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Stream callback function for the Endpoint stream read and write functions. This callback will abort the current stream transfer if a Mass Storage Reset request has been issued to the control endpoint. </p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a31780559e7a9c322e16adb1d2ef4625e"></a><!-- doxytag: member="MassStorage.h::CommandBlock" ref="a31780559e7a9c322e16adb1d2ef4625e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00001.html">CommandBlockWrapper_t</a> <a class="el" href="a00014.html#a31780559e7a9c322e16adb1d2ef4625e">CommandBlock</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Structure to hold the latest Command Block Wrapper issued by the host, containing a SCSI command to execute. </p>

</div>
</div>
<a class="anchor" id="adbb7d1de681baffcbb200c3c4eb8e73e"></a><!-- doxytag: member="MassStorage.h::CommandStatus" ref="adbb7d1de681baffcbb200c3c4eb8e73e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00002.html">CommandStatusWrapper_t</a> <a class="el" href="a00014.html#adbb7d1de681baffcbb200c3c4eb8e73e">CommandStatus</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Structure to hold the latest Command Status Wrapper to return to the host, containing the status of the last issued command. </p>

</div>
</div>
<a class="anchor" id="aa696f7a79b9109ea7f508d87861e1bf9"></a><!-- doxytag: member="MassStorage.h::IsMassStoreReset" ref="aa696f7a79b9109ea7f508d87861e1bf9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile bool <a class="el" href="a00014.html#aa696f7a79b9109ea7f508d87861e1bf9">IsMassStoreReset</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Flag to asynchronously abort any in-progress data transfers upon the reception of a mass storage reset command. </p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 1 Dec 2009 for LUFA Library - Mass Storage Device Demo by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
