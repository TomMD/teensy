<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>AVRISP MKII Programmer Project: Lib/V2ProtocolTarget.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_8a0437e1b3bedee87c5019d75a118412.html">Lib</a>
  </div>
</div>
<div class="contents">
<h1>V2ProtocolTarget.c File Reference</h1><code>#include &quot;<a class="el" href="a00014.html">V2ProtocolTarget.h</a>&quot;</code><br/>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00013.html#addb46e8cf378eafa310e81dfcaa97402">V2Protocol_GetSPIPrescalerMask</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00013.html#aa6b37091add614d2c67bce5fb7bfc33c">V2Protocol_ChangeTargetResetLine</a> (bool ResetTarget)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00013.html#a116484e3b3dd77fa332a85703ce6b08a">V2Protocol_WaitForProgComplete</a> (uint8_t ProgrammingMode, uint16_t PollAddress, uint8_t PollValue, uint8_t DelayMS, uint8_t ReadMemCommand)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00013.html#ace6d7083182f967b02dde35b8d4afc97">V2Protocol_WaitWhileTargetBusy</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00013.html#af5181ff2c73607b7021cb63bb7f69445">V2Protocol_LoadExtendedAddress</a> (void)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00013.html#a8aeaf946005d6a53cfebf877c9a73fd9">CurrentAddress</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Target-related functions for the V2 Protocol decoder. </p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="aa6b37091add614d2c67bce5fb7bfc33c"></a><!-- doxytag: member="V2ProtocolTarget.c::V2Protocol_ChangeTargetResetLine" ref="aa6b37091add614d2c67bce5fb7bfc33c" args="(bool ResetTarget)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void V2Protocol_ChangeTargetResetLine </td>
          <td>(</td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>ResetTarget</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Asserts or deasserts the target's reset line, using the correct polarity as set by the host using a SET PARAM command. When not asserted, the line is tristated so as not to interfere with normal device operation.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ResetTarget</em>&nbsp;</td><td>Boolean true when the target should be held in reset, false otherwise </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="addb46e8cf378eafa310e81dfcaa97402"></a><!-- doxytag: member="V2ProtocolTarget.c::V2Protocol_GetSPIPrescalerMask" ref="addb46e8cf378eafa310e81dfcaa97402" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t V2Protocol_GetSPIPrescalerMask </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Converts the given AVR Studio SCK duration parameter (set by a SET PARAM command from the host) to the nearest possible SPI clock prescaler mask for passing to the SPI_Init() routine.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>Nearest SPI prescaler mask for the given SCK frequency </dd></dl>

</div>
</div>
<a class="anchor" id="af5181ff2c73607b7021cb63bb7f69445"></a><!-- doxytag: member="V2ProtocolTarget.c::V2Protocol_LoadExtendedAddress" ref="af5181ff2c73607b7021cb63bb7f69445" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void V2Protocol_LoadExtendedAddress </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sends a low-level LOAD EXTENDED ADDRESS command to the target, for addressing of memory beyond the 64KB boundary. This sends the command with the correct address as indicated by the current address pointer variable set by the host when a SET ADDRESS command is issued. </p>

</div>
</div>
<a class="anchor" id="a116484e3b3dd77fa332a85703ce6b08a"></a><!-- doxytag: member="V2ProtocolTarget.c::V2Protocol_WaitForProgComplete" ref="a116484e3b3dd77fa332a85703ce6b08a" args="(uint8_t ProgrammingMode, uint16_t PollAddress, uint8_t PollValue, uint8_t DelayMS, uint8_t ReadMemCommand)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t V2Protocol_WaitForProgComplete </td>
          <td>(</td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>ProgrammingMode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&nbsp;</td>
          <td class="paramname"> <em>PollAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>PollValue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>DelayMS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>ReadMemCommand</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Waits until the last issued target memory programming command has completed, via the check mode given and using the given parameters.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ProgrammingMode</em>&nbsp;</td><td>Programming mode used and completion check to use, a mask of PROG_MODE_* constants </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>PollAddress</em>&nbsp;</td><td>Memory address to poll for completion if polling check mode used </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>PollValue</em>&nbsp;</td><td>Poll value to check against if polling check mode used </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>DelayMS</em>&nbsp;</td><td>Milliseconds to delay before returning if delay check mode used </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ReadMemCommand</em>&nbsp;</td><td>Device low-level READ MEMORY command to send if value check mode used</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>V2 Protocol status <a class="el" href="a00010.html#a2c06f068c4eac3fff24312e002868fa1">STATUS_CMD_OK</a> if the no timeout occurred, <a class="el" href="a00010.html#aa6d5ea133f198c3501c524b50f24c063">STATUS_RDY_BSY_TOUT</a> or <a class="el" href="a00010.html#a4266794d90c4c551f31efecb2e0b3368">STATUS_CMD_TOUT</a> otherwise </dd></dl>

</div>
</div>
<a class="anchor" id="ace6d7083182f967b02dde35b8d4afc97"></a><!-- doxytag: member="V2ProtocolTarget.c::V2Protocol_WaitWhileTargetBusy" ref="ace6d7083182f967b02dde35b8d4afc97" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t V2Protocol_WaitWhileTargetBusy </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Waits until the target has completed the last operation, by continuously polling the device's BUSY flag until it is cleared, or until the <a class="el" href="a00014.html#aa47334d3fcdbf0c11076c7076ed79f32">TARGET_BUSY_TIMEOUT_MS</a> timeout period has expired.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>V2 Protocol status <a class="el" href="a00010.html#a2c06f068c4eac3fff24312e002868fa1">STATUS_CMD_OK</a> if the no timeout occurred, <a class="el" href="a00010.html#aa6d5ea133f198c3501c524b50f24c063">STATUS_RDY_BSY_TOUT</a> otherwise </dd></dl>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a8aeaf946005d6a53cfebf877c9a73fd9"></a><!-- doxytag: member="V2ProtocolTarget.c::CurrentAddress" ref="a8aeaf946005d6a53cfebf877c9a73fd9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t <a class="el" href="a00014.html#a8aeaf946005d6a53cfebf877c9a73fd9">CurrentAddress</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Current memory address for FLASH/EEPROM memory read/write commands </p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 1 Dec 2009 for AVRISP MKII Programmer Project by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
